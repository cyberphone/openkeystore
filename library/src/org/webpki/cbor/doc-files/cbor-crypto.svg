<?xml version='1.0' encoding='utf-8'?>
<svg viewBox='0 0 1135 780' xmlns='http://www.w3.org/2000/svg'>
<title>CBOR Encryption Format</title>
<!-- Anders Rundgren 2021 -->
<g stroke='#4366bf' stroke-width='3' fill='none'>
<rect x='20' y='180' width='460' height='80' rx='8'/>
<rect x='20' y='280' width='460' height='80' stroke-dasharray='8' rx='8'/>
<rect x='20' y='380' width='460' height='80' stroke-dasharray='8' rx='8'/>
<rect x='20' y='480' width='460' height='80' rx='8'/>
<rect x='20' y='580' width='460' height='80' rx='8'/>
<rect x='20' y='680' width='460' height='80' rx='8'/>
<rect x='605' y='180' width='510' height='80' rx='8'/>
<rect x='605' y='280' width='510' height='80' stroke-dasharray='8' rx='8'/>
<rect x='605' y='380' width='510' height='80' stroke-dasharray='8' rx='8'/>
<rect x='605' y='480' width='510' height='80' stroke-dasharray='8' rx='8'/>
<rect x='605' y='580' width='510' height='80' stroke-dasharray='8' rx='8'/>
<rect x='605' y='680' width='510' height='80' stroke-dasharray='8' rx='8'/>
</g>
<g font-size='40' font-family='Roboto,sans-serif'>
<text x='250' y='70' font-size='50' text-anchor='middle'>Main Map</text>
<text x='250' y='120' text-anchor='middle'>(Content Encryption)</text>
<text x='860' y='70' font-size='50' text-anchor='middle'>Optional Sub Map</text>
<text x='860' y='120' text-anchor='middle'>(Key Encryption)</text>
</g>
<g font-size='40' font-family='Noto Mono,monospace' fill='maroon'>
<text x='44' y='234'>algorithm<tspan fill='black'> (1)</tspan></text>
<text x='44' y='334'>keyEncryption<tspan fill='black'> (2)</tspan></text>
<text x='44' y='434'>keyId<tspan fill='black'> (3)</tspan></text>
<text x='44' y='534'>tag<tspan fill='black'> (8)</tspan></text>
<text x='44' y='634'>iv<tspan fill='black'> (9)</tspan></text>
<text x='44' y='734'>cipherText<tspan fill='black'> (10)</tspan></text>
<text x='629' y='234'>algorithm<tspan fill='black'> (1)</tspan></text>
<text x='629' y='334'>keyId<tspan fill='black'> (3)</tspan></text>
<text x='629' y='434'>publicKey<tspan fill='black'> (4)</tspan></text>
<text x='629' y='534'>certificatePath<tspan fill='black'> (5)</tspan></text>
<text x='629' y='634'>ephemeralKey<tspan fill='black'> (7)</tspan></text>
<text x='629' y='734'>cipherText<tspan fill='black'> (10)</tspan></text>
</g>
<path fill='none' stroke='#4366bf' stroke-width='3' stroke-linecap='round' d='M500,180  m 85,0 c -33,0 -35,68 -35,68 0,30 -18,68 -48,72 30,8 48,35 48,80 v 286 c 0,0 0,74 36,74'/>
</svg>
